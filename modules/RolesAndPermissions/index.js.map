{"version":3,"sources":["modules/RolesAndPermissions/index.js"],"names":["DEFAULT_TTL","extractData","permissions","output","forEach","item","permission","id","RolesAndPermissions","client","extensionInfo","ttl","options","name","fetchFunction","_client","account","extension","authzProfile","get","readyCheckFn","_extensionInfo","ready","addSelector","data","serviceFeatures","_selectors","RingOut","enabled"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAMA,cAAc,KAAK,EAAL,GAAU,EAAV,GAAe,IAAnC;;AAEA,SAASC,WAAT,CAAqBC,WAArB,EAAkC;AAChC,MAAMC,SAAS,EAAf;AACAD,cAAYA,WAAZ,CAAwBE,OAAxB,CAAgC,UAACC,IAAD,EAAU;AACxCF,WAAOE,KAAKC,UAAL,CAAgBC,EAAvB,IAA6B,IAA7B;AACD,GAFD;AAGA,SAAOJ,MAAP;AACD;;IAEoBK,mB;;;AACnB,qCAKG;AAAA;;AAAA,QAJDC,MAIC,QAJDA,MAIC;AAAA,QAHDC,aAGC,QAHDA,aAGC;AAAA,wBAFDC,GAEC;AAAA,QAFDA,GAEC,4BAFKX,WAEL;AAAA,QADEY,OACF;AAAA;;AAAA,2LAEIA,OAFJ;AAGCC,YAAM,qBAHP;AAICJ,oBAJD;AAKCE,cALD;AAMCG;AAAA,+EAAe;AAAA;AAAA;AAAA;AAAA;AAAA,gCAAYb,WAAZ;AAAA;AAAA,yBACP,MAAKc,OAAL,CAAaC,OAAb,GAAuBC,SAAvB,GAAmCC,YAAnC,GAAkDC,GAAlD,EADO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAf;;AAAA;AAAA;AAAA;AAAA,SAND;AASCC,oBAAc;AAAA,eAAM,MAAKC,cAAL,CAAoBC,KAA1B;AAAA;AATf;;AAWD,UAAKD,cAAL,GAAsBX,aAAtB;AACA,UAAKa,WAAL,CACE,aADF,EAEE;AAAA,aAAM,MAAKC,IAAX;AAAA,KAFF,EAGE;AAAA,aAAQA,QAAQ,EAAhB;AAAA,KAHF;AAZC;AAiBF;;;;wBAEqB;AACpB,aAAO,KAAKH,cAAL,CAAoBI,eAA3B;AACD;;;wBAEiB;AAChB,aAAO,KAAKC,UAAL,CAAgBxB,WAAhB,EAAP;AACD;;;wBAEoB;AACnB,aAAO,KAAKmB,cAAL,CAAoBI,eAApB,IACP,KAAKJ,cAAL,CAAoBI,eAApB,CAAoCE,OAD7B,IAEP,KAAKN,cAAL,CAAoBI,eAApB,CAAoCE,OAApC,CAA4CC,OAF5C;AAGD;;;;;kBArCkBpB,mB","file":"index.js","sourcesContent":["import DataFetcher from '../../lib/DataFetcher';\nimport moduleStatuses from '../../enums/moduleStatuses';\n\nconst DEFAULT_TTL = 24 * 60 * 60 * 1000;\n\nfunction extractData(permissions) {\n  const output = {};\n  permissions.permissions.forEach((item) => {\n    output[item.permission.id] = true;\n  });\n  return output;\n}\n\nexport default class RolesAndPermissions extends DataFetcher {\n  constructor({\n    client,\n    extensionInfo,\n    ttl = DEFAULT_TTL,\n    ...options\n  }) {\n    super({\n      ...options,\n      name: 'rolesAndPermissions',\n      client,\n      ttl,\n      fetchFunction: async () => extractData(\n        await this._client.account().extension().authzProfile().get()\n      ),\n      readyCheckFn: () => this._extensionInfo.ready,\n    });\n    this._extensionInfo = extensionInfo;\n    this.addSelector(\n      'permissions',\n      () => this.data,\n      data => data || {},\n    );\n  }\n\n  get serviceFeatures() {\n    return this._extensionInfo.serviceFeatures;\n  }\n\n  get permissions() {\n    return this._selectors.permissions();\n  }\n\n  get ringoutEnabled() {\n    return this._extensionInfo.serviceFeatures &&\n    this._extensionInfo.serviceFeatures.RingOut &&\n    this._extensionInfo.serviceFeatures.RingOut.enabled;\n  }\n\n}\n"]}