{"version":3,"sources":["modules/DetailedPresence/getDetailedPresenceReducer.js"],"names":["getDataReducer","getDetailedPresenceReducer","types","state","type","activeCalls","timestamp","fetchSuccess","notification","map","activeCall","existingCall","find","call","sessionId","startTime","filter","resetSuccess","getTelephonyStatusReducer","telephonyStatus","status","data","dndStatus"],"mappings":";;;;;;;;;;QAUgBA,c,GAAAA,c;kBAyCQC,0B;;AAnDxB;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AAKO,SAASD,cAAT,CAAwBE,KAAxB,EAA+B;AACpC,SAAO,YAAuD;AAAA,QAAtDC,KAAsD,uEAA9C,EAA8C;AAAA;AAAA,QAAxCC,IAAwC,QAAxCA,IAAwC;AAAA,gCAAlCC,WAAkC;AAAA,QAAlCA,WAAkC,oCAApB,EAAoB;AAAA,QAAhBC,SAAgB,QAAhBA,SAAgB;;AAC5D,YAAQF,IAAR;AACE,WAAKF,MAAMK,YAAX;AACA,WAAKL,MAAMM,YAAX;AAAyB;AACvB,iBAAOH,YACJI,GADI,CACA,UAACC,UAAD,EAAgB;AACnB,gBAAMC,eAAeR,MAAMS,IAAN,CAAW;AAAA,qBAC9BC,KAAKC,SAAL,KAAmBJ,WAAWI,SADA;AAAA,aAAX,CAArB;AAGA,gBAAI,CAACH,YAAL,EAAmB,kCAAY,qCAAgBD,UAAhB,CAAZ,IAAyCK,WAAWT,SAApD;AACnB,gBAAI,wCAAmBI,UAAnB,CAAJ,EAAoC,OAAOC,YAAP;AACpC,8CAAYA,YAAZ,EAA6B,qCAAgBD,UAAhB,CAA7B;AACD,WARI;AASL;AATK,WAUJM,MAVI,CAUG;AAAA,mBAAc,CAAC,wCAAmBN,UAAnB,CAAf;AAAA,WAVH,CAAP;AAWD;AACD,WAAKR,MAAMe,YAAX;AACE,eAAO,EAAP;AACF;AACE,eAAOd,KAAP;AAlBJ;AAoBD,GArBD;AAsBD;;AAGD,SAASe,yBAAT,CAAmChB,KAAnC,EAA0C;AACxC,SAAO,YAAqD;AAAA,QAApDC,KAAoD,uEAA5C,IAA4C;AAAA;AAAA,QAApCC,IAAoC,SAApCA,IAAoC;AAAA,sCAA9Be,eAA8B;AAAA,QAA9BA,eAA8B,yCAAZhB,KAAY;;AAC1D,YAAQC,IAAR;AACE,WAAKF,MAAMK,YAAX;AACA,WAAKL,MAAMM,YAAX;AACE,eAAOW,eAAP;AACF,WAAKjB,MAAMe,YAAX;AACE,eAAO,IAAP;AACF;AACE,eAAOd,KAAP;AAPJ;AASD,GAVD;AAWD;;AAED;AACe,SAASF,0BAAT,CAAoCC,KAApC,EAA2C;AACxD,SAAO,4BAAgB;AACrBkB,YAAQ,sCAAuBlB,KAAvB,CADa;AAErBmB,UAAMrB,eAAeE,KAAf,CAFe;AAGrBoB,eAAW,6CAAoBpB,KAApB,CAHU;AAIrBiB,qBAAiBD,0BAA0BhB,KAA1B;AAJI,GAAhB,CAAP;AAMD","file":"getDetailedPresenceReducer.js","sourcesContent":["import 'core-js/fn/array/find';\nimport 'core-js/fn/array/find-index';\nimport { combineReducers } from 'redux';\nimport { getDndStatusReducer } from '../Presence/getPresenceReducer';\nimport getModuleStatusReducer from '../../lib/getModuleStatusReducer';\nimport {\n  normalizeFromTo,\n  isIntermediateCall,\n} from '../../lib/callLogHelpers';\n\nexport function getDataReducer(types) {\n  return (state = [], { type, activeCalls = [], timestamp }) => {\n    switch (type) {\n      case types.fetchSuccess:\n      case types.notification: {\n        return activeCalls\n          .map((activeCall) => {\n            const existingCall = state.find(call => (\n              call.sessionId === activeCall.sessionId\n            ));\n            if (!existingCall) return { ...normalizeFromTo(activeCall), startTime: timestamp };\n            if (isIntermediateCall(activeCall)) return existingCall;\n            return { ...existingCall, ...normalizeFromTo(activeCall) };\n          })\n          // [RCINT-3558] should ignore intermediate call states\n          .filter(activeCall => !isIntermediateCall(activeCall));\n      }\n      case types.resetSuccess:\n        return [];\n      default:\n        return state;\n    }\n  };\n}\n\n\nfunction getTelephonyStatusReducer(types) {\n  return (state = null, { type, telephonyStatus = state }) => {\n    switch (type) {\n      case types.fetchSuccess:\n      case types.notification:\n        return telephonyStatus;\n      case types.resetSuccess:\n        return null;\n      default:\n        return state;\n    }\n  };\n}\n\n/* istanbul ignore next: unnecessary to test combineReducers */\nexport default function getDetailedPresenceReducer(types) {\n  return combineReducers({\n    status: getModuleStatusReducer(types),\n    data: getDataReducer(types),\n    dndStatus: getDndStatusReducer(types),\n    telephonyStatus: getTelephonyStatusReducer(types),\n  });\n}\n"]}