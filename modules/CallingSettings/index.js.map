{"version":3,"sources":["modules/CallingSettings/index.js"],"names":["CallingSettings","alert","brand","extensionInfo","extensionPhoneNumber","forwardingNumber","storage","rolesAndPermissions","tabManager","onFirstLogin","options","actionTypes","_alert","_brand","_extensionInfo","_extensionPhoneNumber","_forwardingNumber","_storage","_rolesAndPermissions","_tabManager","_callWithStorageKey","_ringoutPromptStorageKey","_myLocationStorageKey","_timestampStorageKey","_onFirstLogin","registerReducer","key","reducer","_reducer","addSelector","directNumbers","mainCompanyNumber","extensionNumber","myPhoneNumbers","map","item","phoneNumber","push","flipNumbers","callerIdNumbers","filterMapping","forEach","filter","sort","a","b","label","ringoutEnabled","webphoneEnabled","otherPhoneNumbers","length","hasOtherPhone","callWithOptions","softphone","webphone","myphone","otherphone","customphone","store","subscribe","ready","status","pending","_myPhoneNumbers","_otherPhoneNumbers","_ringoutEnabled","dispatch","type","init","timestamp","defaultCallWith","browser","setData","callWith","Date","now","warning","message","id","firstLogin","firstLoginOther","_validateSettings","initSuccess","resetSuccess","danger","permissionChanged","ttl","indexOf","myLocation","phoneNumberChanged","withPrompt","ringoutPrompt","info","saveSuccessWithSoftphone","saveSuccess","state","getItem","_selectors","availableNumbers"],"mappings":"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","file":"index.js","sourcesContent":["import RcModule from '../../lib/RcModule';\nimport getCallingSettingsReducer, {\n  getCallWithReducer,\n  getRingoutPromptReducer,\n  getMyLocationReducer,\n  getTimestampReducer,\n} from './getCallingSettingsReducer';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport mapOptionToMode from './mapOptionToMode';\nimport callingOptions from './callingOptions';\nimport callingSettingsMessages from './callingSettingsMessages';\nimport actionTypes from './actionTypes';\n\nexport default class CallingSettings extends RcModule {\n  constructor({\n    alert,\n    brand,\n    extensionInfo,\n    extensionPhoneNumber,\n    forwardingNumber,\n    storage,\n    rolesAndPermissions,\n    tabManager,\n    onFirstLogin,\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._alert = alert;\n    this._brand = brand;\n    this._extensionInfo = extensionInfo;\n    this._extensionPhoneNumber = extensionPhoneNumber;\n    this._forwardingNumber = forwardingNumber;\n    this._storage = storage;\n    this._rolesAndPermissions = rolesAndPermissions;\n    this._tabManager = tabManager;\n\n    this._callWithStorageKey = 'callingSettingsCallWith';\n    this._ringoutPromptStorageKey = 'callingSettingsRingoutPrompt';\n    this._myLocationStorageKey = 'callingSettingsMyLocation';\n    this._timestampStorageKey = 'callingSettingsTimestamp';\n\n    this._onFirstLogin = onFirstLogin;\n\n    this._storage.registerReducer({\n      key: this._callWithStorageKey,\n      reducer: getCallWithReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._ringoutPromptStorageKey,\n      reducer: getRingoutPromptReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._myLocationStorageKey,\n      reducer: getMyLocationReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._timestampStorageKey,\n      reducer: getTimestampReducer(this.actionTypes),\n    });\n    this._reducer = getCallingSettingsReducer(this.actionTypes);\n\n    this.addSelector('myPhoneNumbers',\n      () => this._extensionPhoneNumber.directNumbers,\n      () => this._extensionPhoneNumber.mainCompanyNumber,\n      () => this._extensionInfo.extensionNumber,\n      (directNumbers, mainCompanyNumber, extensionNumber) => {\n        const myPhoneNumbers = directNumbers.map(item => item.phoneNumber);\n        if (mainCompanyNumber && extensionNumber) {\n          myPhoneNumbers.push(`${mainCompanyNumber.phoneNumber}*${extensionNumber}`);\n        }\n        return myPhoneNumbers;\n      }\n    );\n\n    this.addSelector('otherPhoneNumbers',\n      () => this._forwardingNumber.flipNumbers,\n      () => this._extensionPhoneNumber.callerIdNumbers,\n      () => this._extensionPhoneNumber.directNumbers,\n      (flipNumbers, callerIdNumbers, directNumbers) => {\n        const filterMapping = {};\n        callerIdNumbers.forEach((item) => {\n          filterMapping[item.phoneNumber] = true;\n        });\n        directNumbers.forEach((item) => {\n          filterMapping[item.phoneNumber] = true;\n        });\n        return flipNumbers\n          .filter(item => !filterMapping[item.phoneNumber])\n          .sort((a, b) => (a.label === 'Mobile' && a.label !== b.label ? -1 : 1))\n          .map(item => item.phoneNumber);\n      }\n    );\n\n    this.addSelector('callWithOptions',\n      () => this._rolesAndPermissions.ringoutEnabled,\n      () => this._rolesAndPermissions.webphoneEnabled,\n      () => this.otherPhoneNumbers.length > 0,\n      (ringoutEnabled, webphoneEnabled, hasOtherPhone) => {\n        const callWithOptions = [callingOptions.softphone];\n        if (webphoneEnabled) {\n          callWithOptions.push(callingOptions.webphone);\n        }\n        if (ringoutEnabled) {\n          callWithOptions.push(callingOptions.myphone);\n          if (hasOtherPhone) {\n            callWithOptions.push(callingOptions.otherphone);\n          }\n          callWithOptions.push(callingOptions.customphone);\n        }\n        return callWithOptions;\n      },\n    );\n    this.addSelector('availableNumbers',\n      () => this.myPhoneNumbers,\n      () => this.otherPhoneNumbers,\n      (myPhoneNumbers, otherPhoneNumbers) => ({\n        [callingOptions.myphone]: myPhoneNumbers,\n        [callingOptions.otherphone]: otherPhoneNumbers,\n      }),\n    );\n  }\n\n  initialize() {\n    this.store.subscribe(async () => {\n      if (\n        this._storage.ready &&\n        this._extensionInfo.ready &&\n        this._extensionPhoneNumber.ready &&\n        this._forwardingNumber.ready &&\n        this._rolesAndPermissions.ready &&\n        this.status === moduleStatuses.pending\n      ) {\n        this._myPhoneNumbers = this.myPhoneNumbers;\n        this._otherPhoneNumbers = this.otherPhoneNumbers;\n        this._ringoutEnabled = this._rolesAndPermissions.ringoutEnabled;\n        this.store.dispatch({\n          type: this.actionTypes.init,\n        });\n        if (!this.timestamp) {\n          // first time login\n          const defaultCallWith = this._rolesAndPermissions.webphoneEnabled ?\n            callingOptions.browser :\n            callingOptions.softphone;\n          this.store.dispatch({\n            type: this.actionTypes.setData,\n            callWith: defaultCallWith,\n            timestamp: Date.now(),\n          });\n          this._alert.warning({\n            message: this._brand.id === '1210' ?\n              callingSettingsMessages.firstLogin :\n              callingSettingsMessages.firstLoginOther,\n          });\n          if (typeof this._onFirstLogin === 'function') {\n            this._onFirstLogin();\n          }\n        }\n        this._validateSettings();\n        this.store.dispatch({\n          type: this.actionTypes.initSuccess,\n        });\n      } else if (\n        this.ready &&\n        (!this._storage.ready ||\n          !this._extensionInfo.ready ||\n          !this._extensionPhoneNumber.ready ||\n          !this._forwardingNumber.ready ||\n          !this._rolesAndPermissions.ready)\n      ) {\n        this.store.dispatch({\n          type: this.actionTypes.resetSuccess,\n        });\n      } else if (\n        this.ready &&\n        (this._ringoutEnabled !== this._rolesAndPermissions.ringoutEnabled ||\n          this._myPhoneNumbers !== this.myPhoneNumbers ||\n          this._otherPhoneNumbers !== this.otherPhoneNumbers)\n      ) {\n        this._ringoutEnabled = this._rolesAndPermissions.ringoutEnabled;\n        this._myPhoneNumbers = this.myPhoneNumbers;\n        this._otherPhoneNumbers = this.otherPhoneNumbers;\n        this._validateSettings();\n      }\n    });\n  }\n  _validateSettings() {\n    if (\n      !this._ringoutEnabled &&\n      this.callWith !== callingOptions.softphone\n    ) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.softphone,\n        timestamp: Date.now(),\n      });\n      this._alert.danger({\n        message: callingSettingsMessages.permissionChanged,\n        ttl: 0,\n      });\n    } else if (\n      (this.callWith === callingOptions.otherphone &&\n        this._otherPhoneNumbers.indexOf(this.myLocation) === -1) ||\n      (this.callWith === callingOptions.myphone &&\n        this._myPhoneNumbers.indexOf(this.myLocation) === -1)\n    ) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.myphone,\n        myLocation: this._myPhoneNumbers[0],\n        timestamp: Date.now(),\n      });\n      this._alert.danger({\n        message: callingSettingsMessages.phoneNumberChanged,\n        ttl: 0,\n      });\n    }\n  }\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get callWith() {\n    return this._storage.getItem(this._callWithStorageKey);\n  }\n\n  get callingMode() {\n    return mapOptionToMode(this.callWith);\n  }\n\n  get callWithOptions() {\n    return this._selectors.callWithOptions();\n  }\n\n  get ringoutPrompt() {\n    return this._storage.getItem(this._ringoutPromptStorageKey);\n  }\n\n  get myLocation() {\n    return this._storage.getItem(this._myLocationStorageKey);\n  }\n\n  get timestamp() {\n    return this._storage.getItem(this._timestampStorageKey);\n  }\n\n  get myPhoneNumbers() {\n    return this._selectors.myPhoneNumbers();\n  }\n\n  get otherPhoneNumbers() {\n    return this._selectors.otherPhoneNumbers();\n  }\n\n  get availableNumbers() {\n    return this._selectors.availableNumbers();\n  }\n\n  setData({ callWith, myLocation, ringoutPrompt }, withPrompt) {\n    // TODO validate myLocation\n    this.store.dispatch({\n      type: this.actionTypes.setData,\n      callWith,\n      myLocation,\n      ringoutPrompt,\n      timestamp: Date.now(),\n    });\n    if (withPrompt) {\n      if (this.callWith === callingOptions.softphone) {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccessWithSoftphone,\n        });\n      } else {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccess,\n        });\n      }\n    }\n  }\n}\n"]}