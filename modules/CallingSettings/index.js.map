{"version":3,"sources":["modules/CallingSettings/index.js"],"names":["CallingSettings","alert","brand","extensionInfo","extensionPhoneNumber","forwardingNumber","storage","rolesAndPermissions","tabManager","onFirstLogin","options","actionTypes","_alert","_brand","_extensionInfo","_extensionPhoneNumber","_forwardingNumber","_storage","_rolesAndPermissions","_tabManager","_callWithStorageKey","_ringoutPromptStorageKey","_myLocationStorageKey","_timestampStorageKey","_onFirstLogin","registerReducer","key","reducer","_reducer","addSelector","directNumbers","mainCompanyNumber","extensionNumber","myPhoneNumbers","map","item","phoneNumber","push","flipNumbers","callerIdNumbers","filterMapping","forEach","filter","sort","a","b","label","ringoutEnabled","otherPhoneNumbers","length","hasOtherPhone","callWithOptions","softphone","myphone","otherphone","customphone","store","subscribe","ready","status","pending","_myPhoneNumbers","_otherPhoneNumbers","_ringoutEnabled","dispatch","type","init","timestamp","setData","Date","now","warning","message","id","firstLogin","firstLoginOther","_validateSettings","initSuccess","resetSuccess","callWith","danger","permissionChanged","ttl","indexOf","myLocation","phoneNumberChanged","withPrompt","ringoutPrompt","info","saveSuccessWithSoftphone","saveSuccess","state","getItem","_selectors","availableNumbers"],"mappings":"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","file":"index.js","sourcesContent":["import RcModule from '../../lib/RcModule';\nimport getCallingSettingsReducer, {\n  getCallWithReducer,\n  getRingoutPromptReducer,\n  getMyLocationReducer,\n  getTimestampReducer,\n} from './getCallingSettingsReducer';\nimport moduleStatus from '../../enums/moduleStatus';\nimport mapOptionToMode from './mapOptionToMode';\nimport callingOptions from './callingOptions';\nimport callingSettingsMessages from './callingSettingsMessages';\nimport actionTypes from './actionTypes';\n\nexport default class CallingSettings extends RcModule {\n  constructor({\n    alert,\n    brand,\n    extensionInfo,\n    extensionPhoneNumber,\n    forwardingNumber,\n    storage,\n    rolesAndPermissions,\n    tabManager,\n    onFirstLogin,\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._alert = alert;\n    this._brand = brand;\n    this._extensionInfo = extensionInfo;\n    this._extensionPhoneNumber = extensionPhoneNumber;\n    this._forwardingNumber = forwardingNumber;\n    this._storage = storage;\n    this._rolesAndPermissions = rolesAndPermissions;\n    this._tabManager = tabManager;\n\n    this._callWithStorageKey = 'callingSettingsCallWith';\n    this._ringoutPromptStorageKey = 'callingSettingsRingoutPrompt';\n    this._myLocationStorageKey = 'callingSettingsMyLocation';\n    this._timestampStorageKey = 'callingSettingsTimestamp';\n\n    this._onFirstLogin = onFirstLogin;\n\n    this._storage.registerReducer({\n      key: this._callWithStorageKey,\n      reducer: getCallWithReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._ringoutPromptStorageKey,\n      reducer: getRingoutPromptReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._myLocationStorageKey,\n      reducer: getMyLocationReducer(this.actionTypes),\n    });\n    this._storage.registerReducer({\n      key: this._timestampStorageKey,\n      reducer: getTimestampReducer(this.actionTypes),\n    });\n    this._reducer = getCallingSettingsReducer(this.actionTypes);\n\n    this.addSelector('myPhoneNumbers',\n      () => this._extensionPhoneNumber.directNumbers,\n      () => this._extensionPhoneNumber.mainCompanyNumber,\n      () => this._extensionInfo.extensionNumber,\n      (directNumbers, mainCompanyNumber, extensionNumber) => {\n        const myPhoneNumbers = directNumbers.map(item => item.phoneNumber);\n        if (mainCompanyNumber && extensionNumber) {\n          myPhoneNumbers.push(`${mainCompanyNumber.phoneNumber}*${extensionNumber}`);\n        }\n        return myPhoneNumbers;\n      }\n    );\n\n    this.addSelector('otherPhoneNumbers',\n      () => this._forwardingNumber.flipNumbers,\n      () => this._extensionPhoneNumber.callerIdNumbers,\n      () => this._extensionPhoneNumber.directNumbers,\n      (flipNumbers, callerIdNumbers, directNumbers) => {\n        const filterMapping = {};\n        callerIdNumbers.forEach((item) => {\n          filterMapping[item.phoneNumber] = true;\n        });\n        directNumbers.forEach((item) => {\n          filterMapping[item.phoneNumber] = true;\n        });\n        return flipNumbers\n          .filter(item => !filterMapping[item.phoneNumber])\n          .sort((a, b) => (a.label === 'Mobile' && a.label !== b.label ? -1 : 1))\n          .map(item => item.phoneNumber);\n      }\n    );\n\n    this.addSelector('callWithOptions',\n      () => this._rolesAndPermissions.ringoutEnabled,\n      () => this.otherPhoneNumbers.length > 0,\n      (ringoutEnabled, hasOtherPhone) => {\n        const callWithOptions = [callingOptions.softphone];\n        if (ringoutEnabled) {\n          callWithOptions.push(callingOptions.myphone);\n          if (hasOtherPhone) {\n            callWithOptions.push(callingOptions.otherphone);\n          }\n          callWithOptions.push(callingOptions.customphone);\n        }\n        return callWithOptions;\n      },\n    );\n    this.addSelector('availableNumbers',\n      () => this.myPhoneNumbers,\n      () => this.otherPhoneNumbers,\n      (myPhoneNumbers, otherPhoneNumbers) => ({\n        [callingOptions.myphone]: myPhoneNumbers,\n        [callingOptions.otherphone]: otherPhoneNumbers,\n      }),\n    );\n  }\n\n  initialize() {\n    this.store.subscribe(async () => {\n      if (\n        this._storage.ready &&\n        this._extensionInfo.ready &&\n        this._extensionPhoneNumber.ready &&\n        this._forwardingNumber.ready &&\n        this._rolesAndPermissions.ready &&\n        this.status === moduleStatus.pending\n      ) {\n        this._myPhoneNumbers = this.myPhoneNumbers;\n        this._otherPhoneNumbers = this.otherPhoneNumbers;\n        this._ringoutEnabled = this._rolesAndPermissions.ringoutEnabled;\n        this.store.dispatch({\n          type: this.actionTypes.init,\n        });\n        if (!this.timestamp) {\n          // first time login\n          this.store.dispatch({\n            type: this.actionTypes.setData,\n            timestamp: Date.now(),\n          });\n          this._alert.warning({\n            message: this._brand.id === '1210' ?\n              callingSettingsMessages.firstLogin :\n              callingSettingsMessages.firstLoginOther,\n          });\n          if (typeof this._onFirstLogin === 'function') {\n            this._onFirstLogin();\n          }\n        }\n        this._validateSettings();\n        this.store.dispatch({\n          type: this.actionTypes.initSuccess,\n        });\n      } else if (\n        this.ready &&\n        (!this._storage.ready ||\n          !this._extensionInfo.ready ||\n          !this._extensionPhoneNumber.ready ||\n          !this._forwardingNumber.ready ||\n          !this._rolesAndPermissions.ready)\n      ) {\n        this.store.dispatch({\n          type: this.actionTypes.resetSuccess,\n        });\n      } else if (\n        this.ready &&\n        (this._ringoutEnabled !== this._rolesAndPermissions.ringoutEnabled ||\n          this._myPhoneNumbers !== this.myPhoneNumbers ||\n          this._otherPhoneNumbers !== this.otherPhoneNumbers)\n      ) {\n        this._ringoutEnabled = this._rolesAndPermissions.ringoutEnabled;\n        this._myPhoneNumbers = this.myPhoneNumbers;\n        this._otherPhoneNumbers = this.otherPhoneNumbers;\n        this._validateSettings();\n      }\n    });\n  }\n  _validateSettings() {\n    if (\n      !this._ringoutEnabled &&\n      this.callWith !== callingOptions.softphone\n    ) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.softphone,\n        timestamp: Date.now(),\n      });\n      this._alert.danger({\n        message: callingSettingsMessages.permissionChanged,\n        ttl: 0,\n      });\n    } else if (\n      (this.callWith === callingOptions.otherphone &&\n        this._otherPhoneNumbers.indexOf(this.myLocation) === -1) ||\n      (this.callWith === callingOptions.myphone &&\n        this._myPhoneNumbers.indexOf(this.myLocation) === -1)\n    ) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.myphone,\n        myLocation: this._myPhoneNumbers[0],\n        timestamp: Date.now(),\n      });\n      this._alert.danger({\n        message: callingSettingsMessages.phoneNumberChanged,\n        ttl: 0,\n      });\n    }\n  }\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatus.ready;\n  }\n\n  get callWith() {\n    return this._storage.getItem(this._callWithStorageKey);\n  }\n\n  get callingMode() {\n    return mapOptionToMode(this.callWith);\n  }\n\n  get callWithOptions() {\n    return this._selectors.callWithOptions();\n  }\n\n  get ringoutPrompt() {\n    return this._storage.getItem(this._ringoutPromptStorageKey);\n  }\n\n  get myLocation() {\n    return this._storage.getItem(this._myLocationStorageKey);\n  }\n\n  get timestamp() {\n    return this._storage.getItem(this._timestampStorageKey);\n  }\n\n  get myPhoneNumbers() {\n    return this._selectors.myPhoneNumbers();\n  }\n\n  get otherPhoneNumbers() {\n    return this._selectors.otherPhoneNumbers();\n  }\n\n  get availableNumbers() {\n    return this._selectors.availableNumbers();\n  }\n\n  setData({ callWith, myLocation, ringoutPrompt }, withPrompt) {\n    // TODO validate myLocation\n    this.store.dispatch({\n      type: this.actionTypes.setData,\n      callWith,\n      myLocation,\n      ringoutPrompt,\n      timestamp: Date.now(),\n    });\n    if (withPrompt) {\n      if (this.callWith === callingOptions.softphone) {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccessWithSoftphone,\n        });\n      } else {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccess,\n        });\n      }\n    }\n  }\n}\n"]}