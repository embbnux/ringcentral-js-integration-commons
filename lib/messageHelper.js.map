{"version":3,"sources":["lib/messageHelper.js"],"names":["filterNumbers","messageIsDeleted","messageIsTextMessage","messageIsFax","messageIsVoicemail","messageIsAcceptable","getMyNumberFromMessage","uniqueRecipients","getRecipientNumbersFromMessage","getRecipients","numbers","filterNumber","filter","number","phoneNumber","extensionNumber","message","availability","type","direction","myExtensionNumber","from","myNumber","to","find","recipients","recipientMap","forEach","recipient","allRecipients","concat","length","push"],"mappings":"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","file":"messageHelper.js","sourcesContent":["export function filterNumbers(numbers, filterNumber) {\n  return numbers.filter((number) => {\n    if (filterNumber.phoneNumber) {\n      return filterNumber.phoneNumber !== number.phoneNumber;\n    }\n    return filterNumber.extensionNumber !== number.extensionNumber;\n  });\n}\n\nexport function messageIsDeleted(message) {\n  return message.availability === 'Deleted';\n}\n\nexport function messageIsTextMessage(message) {\n  return (message.type !== 'Fax' && message.type !== 'VoiceMail');\n}\n\nexport function messageIsFax(message) {\n  return (message.type === 'Fax');\n}\n\nexport function messageIsVoicemail(message) {\n  return (message.type === 'VoiceMail');\n}\n\nexport function messageIsAcceptable(message) {\n  // do not show outbound faxes\n  // do not show deleted messages\n  return (message.type !== 'Fax' || message.direction === 'Inbound') &&\n    (!messageIsDeleted(message));\n}\n\nexport function getMyNumberFromMessage({ message, myExtensionNumber }) {\n  if (!message) {\n    return null;\n  }\n  if (message.direction === 'Outbound') {\n    return message.from;\n  }\n  if (message.type === 'Pager') {\n    const myNumber = message.to.find(number => (\n      number.extensionNumber === myExtensionNumber\n    ));\n    if (myNumber) {\n      return myNumber;\n    }\n    return { extensionNumber: myExtensionNumber };\n  }\n  return message.to[0];\n}\n\nexport function uniqueRecipients(recipients) {\n  const recipientMap = {};\n  recipients.forEach((recipient) => {\n    recipientMap[JSON.stringify(recipient)] = recipient;\n  });\n  return Object.values(recipientMap);\n}\n\nexport function getRecipientNumbersFromMessage({ message, myNumber }) {\n  if (!message) {\n    return [];\n  }\n  if (message.type === 'SMS') {\n    if (message.direction === 'Outbound') {\n      return message.to;\n    }\n    return [message.from];\n  }\n  const allRecipients = [message.from].concat(message.to);\n  const recipients = filterNumbers(allRecipients, myNumber);\n  if (recipients.length === 0) {\n    recipients.push(myNumber);\n  }\n  return uniqueRecipients(recipients);\n}\n\nexport function getRecipients({ message, myExtensionNumber }) {\n  const myNumber = getMyNumberFromMessage({\n    message,\n    myExtensionNumber,\n  });\n  return getRecipientNumbersFromMessage({\n    message,\n    myNumber,\n  });\n}\n"]}