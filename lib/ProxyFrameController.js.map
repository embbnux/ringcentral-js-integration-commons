{"version":3,"sources":["lib/ProxyFrameController.js"],"names":["ProxyFrameController","prefix","window","oAuthCallback","callbackUri","parent","postMessage","addEventListener","data","oAuthUri","key","e","newValue","fromLocalStorage","localStorage","removeItem","proxyLoaded"],"mappings":";;;;;;;;;;;AAAA;;;;;;IAEqBA,oB,GACnB,gCAEQ;AAAA,iFAAJ,EAAI;AAAA,MADNC,MACM,QADNA,MACM;;AAAA;;AACNC,SAAOC,aAAP,GAAuB,UAACC,WAAD,EAAiB;AACtCF,WAAOG,MAAP,CAAcC,WAAd,CAA0B;AACxBF;AADwB,KAA1B,EAEG,GAFH;AAGD,GAJD;;AAMAF,SAAOK,gBAAP,CAAwB,SAAxB,EAAmC,iBAAc;AAAA,QAAXC,IAAW,SAAXA,IAAW;;AAC/C,QAAIA,IAAJ,EAAU;AAAA,UAENC,QAFM,GAGJD,IAHI,CAENC,QAFM;;AAIR,UAAIA,YAAY,IAAhB,EAAsB;AACpB,iCAAUA,QAAV,EAAoB,UAApB,EAAgC,GAAhC,EAAqC,GAArC;AACD;AACF;AACF,GATD;;AAWA,MAAMC,MAAST,MAAT,0BAAN;AACAC,SAAOK,gBAAP,CAAwB,SAAxB,EAAmC,UAACI,CAAD,EAAO;AACxC,QAAIA,EAAED,GAAF,KAAUA,GAAV,IAAiBC,EAAEC,QAAnB,IAA+BD,EAAEC,QAAF,KAAe,EAAlD,EAAsD;AACpD,UAAMR,cAAcO,EAAEC,QAAtB;AACAV,aAAOG,MAAP,CAAcC,WAAd,CAA0B;AACxBF,gCADwB;AAExBS,0BAAkB;AAFM,OAA1B,EAGG,GAHH;AAIAC,mBAAaC,UAAb,CAAwBL,GAAxB;AACD;AACF,GATD;AAUA;AACAR,SAAOG,MAAP,CAAcC,WAAd,CAA0B;AACxBU,iBAAa;AADW,GAA1B,EAEG,GAFH;AAGD,C;;kBApCkBhB,oB","file":"ProxyFrameController.js","sourcesContent":["import popWindow from './popWindow';\n\nexport default class ProxyFrameController {\n  constructor({\n    prefix,\n  } = {}) {\n    window.oAuthCallback = (callbackUri) => {\n      window.parent.postMessage({\n        callbackUri,\n      }, '*');\n    };\n\n    window.addEventListener('message', ({ data }) => {\n      if (data) {\n        const {\n          oAuthUri,\n        } = data;\n        if (oAuthUri != null) {\n          popWindow(oAuthUri, 'rc-oauth', 600, 600);\n        }\n      }\n    });\n\n    const key = `${prefix}-redirect-callbackUri`;\n    window.addEventListener('storage', (e) => {\n      if (e.key === key && e.newValue && e.newValue !== '') {\n        const callbackUri = e.newValue;\n        window.parent.postMessage({\n          callbackUri,\n          fromLocalStorage: true,\n        }, '*');\n        localStorage.removeItem(key);\n      }\n    });\n    // loaded\n    window.parent.postMessage({\n      proxyLoaded: true,\n    }, '*');\n  }\n}\n"]}